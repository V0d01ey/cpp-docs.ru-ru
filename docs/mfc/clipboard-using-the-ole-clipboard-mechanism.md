---
title: Буфер обмена. Использование механизма буфера обмена OLE
ms.date: 11/04/2016
helpviewer_keywords:
- applications [OLE], Clipboard
- OLE Clipboard
- Clipboard [MFC], OLE formats
- OLE Clipboard, formats
- formats [MFC], Clipboard for OLE
ms.assetid: 229cc610-5bb1-435e-bd20-2c8b9964d1af
ms.openlocfilehash: da0b99e6c9c803f3c3a4c09d67853649a4bac314
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84626058"
---
# <a name="clipboard-using-the-ole-clipboard-mechanism"></a>Буфер обмена. Использование механизма буфера обмена OLE

OLE использует стандартные форматы и некоторые форматы, характерные для OLE, для передачи данных через буфер обмена.

При вырезании или копировании данных из приложения данные сохраняются в буфере обмена для последующего использования в операциях вставки. Эти данные находятся в различных форматах. Когда пользователь выбирает вставку данных из буфера обмена, приложение может выбрать, какой из этих форматов следует использовать. Приложение должно быть написано, чтобы выбрать формат, который предоставляет наибольшую информацию, если пользователь специально не запрашивает определенный формат, используя команду Специальная вставка. Прежде чем продолжить, можно прочитать статьи [объекты данных и источники данных (OLE)](data-objects-and-data-sources-ole.md) . Они описывают принципы работы передачи данных и их реализации в приложениях.

Windows определяет ряд стандартных форматов, которые можно использовать для передачи данных через буфер обмена. К ним относятся метафайлы, текст, точечные рисунки и другие. OLE определяет также ряд форматов, характерных для OLE. Для приложений, для которых требуется больше сведений, чем задано этими стандартными форматами, рекомендуется зарегистрировать собственные пользовательские форматы буфера обмена. Для этого используйте функцию Win32 API [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformatw).

Например, Microsoft Excel регистрирует пользовательский формат для электронных таблиц. Этот формат содержит гораздо больше информации, чем, например, точечный рисунок. При вставлении этих данных в приложение, которое поддерживает формат электронной таблицы, все формулы и значения из электронной таблицы сохраняются и могут быть обновлены при необходимости. Microsoft Excel также помещает данные в буфер обмена в форматах, чтобы их можно было вставлять как элемент OLE. Любой контейнер документов OLE может вставить эту информацию как внедренный элемент. Этот внедренный элемент можно изменить с помощью Microsoft Excel. Буфер обмена также содержит простое растровое изображение выбранного диапазона в электронной таблице. Его также можно вставить в контейнеры документов OLE или в растровые редакторы, например Paint. Однако в случае точечного рисунка невозможно управлять данными в виде электронной таблицы.

Чтобы получить максимальный объем сведений из буфера обмена, приложения должны проверить эти пользовательские форматы перед тем, как вставлять данные из буфера обмена.

Например, чтобы включить команду Cut, можно написать обработчик примерно следующего вида:

[!code-cpp[NVC_MFCListView#3](../atl/reference/codesnippet/cpp/clipboard-using-the-ole-clipboard-mechanism_1.cpp)]

## <a name="what-do-you-want-to-know-more-about"></a>Что вы хотите узнать подробнее

- [Копирование и вставка данных](clipboard-copying-and-pasting-data.md)

- [Добавление других форматов](clipboard-adding-other-formats.md)

- [Использование буфера обмена Windows](clipboard-using-the-windows-clipboard.md)

- [OLE](ole-background.md)

- [Объекты данных OLE и источники данных и унифицированная отправка данных](data-objects-and-data-sources-ole.md)

## <a name="see-also"></a>См. также раздел

[Буфер обмена](clipboard.md)
